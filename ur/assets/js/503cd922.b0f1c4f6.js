"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_textbook=globalThis.webpackChunkphysical_ai_humanoid_robotics_textbook||[]).push([[8191],{819(e,n,s){s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>m,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"chapters/chapter-02-ros2-architecture/code-examples","title":"Code Examples: ROS 2 Architecture","description":"Practical ROS 2 code examples demonstrating nodes, topics, and QoS policies","source":"@site/docs/chapters/chapter-02-ros2-architecture/code-examples.md","sourceDirName":"chapters/chapter-02-ros2-architecture","slug":"/chapters/chapter-02-ros2-architecture/code-examples","permalink":"/Ai--book-/ur/docs/chapters/chapter-02-ros2-architecture/code-examples","draft":false,"unlisted":false,"editUrl":"https://github.com/aurangzaibmughal/Ai--book-/edit/main/docs/chapters/chapter-02-ros2-architecture/code-examples.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"id":"code-examples","title":"Code Examples: ROS 2 Architecture","sidebar_label":"Code Examples","sidebar_position":6,"description":"Practical ROS 2 code examples demonstrating nodes, topics, and QoS policies"},"sidebar":"tutorialSidebar","previous":{"title":"Core Concepts","permalink":"/Ai--book-/ur/docs/chapters/chapter-02-ros2-architecture/concepts"},"next":{"title":"Exercises","permalink":"/Ai--book-/ur/docs/chapters/chapter-02-ros2-architecture/exercises"}}');var i=s(4848),t=s(8453);const o={id:"code-examples",title:"Code Examples: ROS 2 Architecture",sidebar_label:"Code Examples",sidebar_position:6,description:"Practical ROS 2 code examples demonstrating nodes, topics, and QoS policies"},a="Code Examples: ROS 2 Architecture",l={},c=[{value:"Example 1: Minimal Publisher Node",id:"example-1-minimal-publisher-node",level:2},{value:"Code: <code>temperature_publisher.py</code>",id:"code-temperature_publisherpy",level:3},{value:"Running the Example",id:"running-the-example",level:3},{value:"Key Concepts Demonstrated",id:"key-concepts-demonstrated",level:3},{value:"Example 2: Minimal Subscriber Node",id:"example-2-minimal-subscriber-node",level:2},{value:"Code: <code>temperature_subscriber.py</code>",id:"code-temperature_subscriberpy",level:3},{value:"Running with Parameters",id:"running-with-parameters",level:3},{value:"Key Concepts Demonstrated",id:"key-concepts-demonstrated-1",level:3},{value:"Example 3: QoS Policies in Action",id:"example-3-qos-policies-in-action",level:2},{value:"Code: <code>qos_demo.py</code>",id:"code-qos_demopy",level:3},{value:"Running the QoS Demo",id:"running-the-qos-demo",level:3},{value:"Experiment: QoS Incompatibility",id:"experiment-qos-incompatibility",level:3},{value:"Example 4: Multi-Node System",id:"example-4-multi-node-system",level:2},{value:"Code: <code>camera_simulator.py</code>",id:"code-camera_simulatorpy",level:3},{value:"Code: <code>image_processor.py</code>",id:"code-image_processorpy",level:3},{value:"Running the Multi-Node System",id:"running-the-multi-node-system",level:3},{value:"Example 5: Using ROS 2 CLI Tools",id:"example-5-using-ros-2-cli-tools",level:2},{value:"Introspection Commands",id:"introspection-commands",level:3},{value:"Common Pitfalls and Solutions",id:"common-pitfalls-and-solutions",level:2},{value:"Pitfall 1: QoS Incompatibility",id:"pitfall-1-qos-incompatibility",level:3},{value:"Pitfall 2: Forgetting to Source Setup",id:"pitfall-2-forgetting-to-source-setup",level:3},{value:"Pitfall 3: Node Name Conflicts",id:"pitfall-3-node-name-conflicts",level:3},{value:"Pitfall 4: Callback Blocking",id:"pitfall-4-callback-blocking",level:3},{value:"Summary",id:"summary",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"code-examples-ros-2-architecture",children:"Code Examples: ROS 2 Architecture"})}),"\n",(0,i.jsx)(n.p,{children:"This section provides working code examples that demonstrate core ROS 2 concepts. All examples are tested with ROS 2 Humble on Ubuntu 22.04."}),"\n",(0,i.jsx)(n.h2,{id:"example-1-minimal-publisher-node",children:"Example 1: Minimal Publisher Node"}),"\n",(0,i.jsx)(n.p,{children:"This example creates a simple publisher that sends temperature sensor data at 10Hz."}),"\n",(0,i.jsxs)(n.h3,{id:"code-temperature_publisherpy",children:["Code: ",(0,i.jsx)(n.code,{children:"temperature_publisher.py"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'#!/usr/bin/env python3\n"""\nTemperature Sensor Publisher\nSimulates a temperature sensor publishing data at 10Hz\n"""\n\nfrom typing import Optional\nimport rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import Temperature\nimport random\n\n\nclass TemperatureSensorNode(Node):\n    """Publishes simulated temperature readings"""\n\n    def __init__(self) -> None:\n        # Initialize the node with a unique name\n        super().__init__(\'temperature_sensor\')\n\n        # Create publisher for temperature topic\n        # QoS depth=10 means buffer last 10 messages if subscriber is slow\n        self.publisher_ = self.create_publisher(\n            Temperature,           # Message type\n            \'robot/temperature\',   # Topic name\n            10                     # QoS depth\n        )\n\n        # Create timer that calls publish_temperature every 0.1 seconds (10Hz)\n        self.timer = self.create_timer(0.1, self.publish_temperature)\n\n        # Initialize simulated temperature\n        self.base_temperature: float = 25.0  # Celsius\n\n        self.get_logger().info(\'Temperature sensor node started\')\n\n    def publish_temperature(self) -> None:\n        """Callback function called by timer to publish temperature"""\n        msg = Temperature()\n\n        # Set message header\n        msg.header.stamp = self.get_clock().now().to_msg()\n        msg.header.frame_id = \'base_link\'\n\n        # Simulate temperature with small random variation\n        # NOTE: We use random values here to simulate real sensor noise.\n        # Real sensors have measurement uncertainty and environmental variations.\n        # In production code, you would read from actual hardware sensors.\n        # For deterministic testing, replace with: msg.temperature = self.base_temperature\n        msg.temperature = self.base_temperature + random.uniform(-0.5, 0.5)\n        msg.variance = 0.1  # Sensor accuracy (\xb10.1\xb0C)\n\n        # Publish the message\n        self.publisher_.publish(msg)\n\n        # Log at DEBUG level (won\'t show by default)\n        self.get_logger().debug(f\'Published: {msg.temperature:.2f}\xb0C\')\n\n\ndef main(args: Optional[list] = None) -> None:\n    # Initialize ROS 2 Python client library\n    rclpy.init(args=args)\n\n    # Create the node\n    node = TemperatureSensorNode()\n\n    # Spin (keep the node running and processing callbacks)\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n\n    # Cleanup\n    node.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n",(0,i.jsx)(n.h3,{id:"running-the-example",children:"Running the Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Make the script executable\nchmod +x temperature_publisher.py\n\n# Run the node\npython3 temperature_publisher.py\n\n# In another terminal, echo the topic to see messages\nros2 topic echo /robot/temperature\n\n# Check publishing rate\nros2 topic hz /robot/temperature\n"})}),"\n",(0,i.jsx)(n.h3,{id:"key-concepts-demonstrated",children:"Key Concepts Demonstrated"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Node Initialization"}),": ",(0,i.jsx)(n.code,{children:"super().__init__('temperature_sensor')"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Publisher Creation"}),": ",(0,i.jsx)(n.code,{children:"create_publisher(msg_type, topic, qos_depth)"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Timer-Based Publishing"}),": Ensures consistent 10Hz rate"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Message Headers"}),": Timestamp and frame_id for sensor fusion"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Logging"}),": Using ROS 2's built-in logger"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"example-2-minimal-subscriber-node",children:"Example 2: Minimal Subscriber Node"}),"\n",(0,i.jsx)(n.p,{children:"This subscriber receives and processes temperature data."}),"\n",(0,i.jsxs)(n.h3,{id:"code-temperature_subscriberpy",children:["Code: ",(0,i.jsx)(n.code,{children:"temperature_subscriber.py"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n\"\"\"\nTemperature Monitor Subscriber\nReceives temperature data and triggers alerts if too high\n\"\"\"\n\nimport rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import Temperature\n\n\nclass TemperatureMonitorNode(Node):\n    \"\"\"Monitors temperature and logs warnings if threshold exceeded\"\"\"\n\n    def __init__(self):\n        super().__init__('temperature_monitor')\n\n        # Declare parameters with default values\n        self.declare_parameter('warning_threshold', 30.0)\n        self.declare_parameter('critical_threshold', 35.0)\n\n        # Get parameter values\n        self.warning_temp = self.get_parameter('warning_threshold').value\n        self.critical_temp = self.get_parameter('critical_threshold').value\n\n        # Create subscriber\n        self.subscription = self.create_subscription(\n            Temperature,\n            'robot/temperature',\n            self.temperature_callback,\n            10  # QoS depth\n        )\n\n        self.get_logger().info(\n            f'Temperature monitor started '\n            f'(warning: {self.warning_temp}\xb0C, critical: {self.critical_temp}\xb0C)'\n        )\n\n    def temperature_callback(self, msg):\n        \"\"\"Called whenever a new temperature message arrives\"\"\"\n        temp = msg.temperature\n\n        # Check thresholds and log appropriately\n        if temp >= self.critical_temp:\n            self.get_logger().error(\n                f'CRITICAL: Temperature {temp:.2f}\xb0C exceeds {self.critical_temp}\xb0C!'\n            )\n        elif temp >= self.warning_temp:\n            self.get_logger().warn(\n                f'WARNING: Temperature {temp:.2f}\xb0C exceeds {self.warning_temp}\xb0C'\n            )\n        else:\n            self.get_logger().debug(f'Temperature normal: {temp:.2f}\xb0C')\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = TemperatureMonitorNode()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n\n    node.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"running-with-parameters",children:"Running with Parameters"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Run with default thresholds\npython3 temperature_subscriber.py\n\n# Run with custom thresholds\nros2 run <package_name> temperature_subscriber \\\n    --ros-args \\\n    -p warning_threshold:=28.0 \\\n    -p critical_threshold:=32.0\n\n# Set log level to see DEBUG messages\nros2 run <package_name> temperature_subscriber \\\n    --ros-args --log-level debug\n"})}),"\n",(0,i.jsx)(n.h3,{id:"key-concepts-demonstrated-1",children:"Key Concepts Demonstrated"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Subscriber Creation"}),": ",(0,i.jsx)(n.code,{children:"create_subscription(msg_type, topic, callback, qos)"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Callback Functions"}),": Executed when messages arrive"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Parameters"}),": Runtime configuration without code changes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Logging Levels"}),": DEBUG, INFO, WARN, ERROR"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"example-3-qos-policies-in-action",children:"Example 3: QoS Policies in Action"}),"\n",(0,i.jsx)(n.p,{children:"This example demonstrates different QoS configurations for different use cases."}),"\n",(0,i.jsxs)(n.h3,{id:"code-qos_demopy",children:["Code: ",(0,i.jsx)(n.code,{children:"qos_demo.py"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n\"\"\"\nQoS Policy Demonstration\nShows how different QoS settings affect message delivery\n\"\"\"\n\nimport rclpy\nfrom rclpy.node import Node\nfrom rclpy.qos import QoSProfile, ReliabilityPolicy, DurabilityPolicy, HistoryPolicy\nfrom std_msgs.msg import String\nimport time\n\n\nclass QoSDemoNode(Node):\n    \"\"\"Demonstrates various QoS configurations\"\"\"\n\n    def __init__(self):\n        super().__init__('qos_demo')\n\n        # 1. RELIABLE QoS - Guaranteed delivery (like TCP)\n        reliable_qos = QoSProfile(\n            reliability=ReliabilityPolicy.RELIABLE,\n            durability=DurabilityPolicy.VOLATILE,\n            history=HistoryPolicy.KEEP_LAST,\n            depth=10\n        )\n\n        self.reliable_pub = self.create_publisher(\n            String,\n            'reliable_topic',\n            reliable_qos\n        )\n\n        # 2. BEST_EFFORT QoS - No delivery guarantee (like UDP)\n        best_effort_qos = QoSProfile(\n            reliability=ReliabilityPolicy.BEST_EFFORT,\n            durability=DurabilityPolicy.VOLATILE,\n            history=HistoryPolicy.KEEP_LAST,\n            depth=1  # Only keep latest\n        )\n\n        self.best_effort_pub = self.create_publisher(\n            String,\n            'best_effort_topic',\n            best_effort_qos\n        )\n\n        # 3. TRANSIENT_LOCAL - Late-joiners get last message\n        transient_qos = QoSProfile(\n            reliability=ReliabilityPolicy.RELIABLE,\n            durability=DurabilityPolicy.TRANSIENT_LOCAL,\n            history=HistoryPolicy.KEEP_LAST,\n            depth=1\n        )\n\n        self.config_pub = self.create_publisher(\n            String,\n            'config_topic',\n            transient_qos\n        )\n\n        # Publish configuration once (late-joiners will still receive it)\n        config_msg = String()\n        config_msg.data = \"Robot Configuration: Mode=Autonomous, Speed=1.5m/s\"\n        self.config_pub.publish(config_msg)\n        self.get_logger().info(f'Published config: {config_msg.data}')\n\n        # Timer for continuous publishing\n        self.timer = self.create_timer(0.5, self.publish_messages)\n        self.counter = 0\n\n    def publish_messages(self):\n        \"\"\"Publish messages with different QoS\"\"\"\n        self.counter += 1\n\n        # Reliable message (critical command)\n        reliable_msg = String()\n        reliable_msg.data = f\"COMMAND #{self.counter}: Execute task\"\n        self.reliable_pub.publish(reliable_msg)\n\n        # Best-effort message (high-frequency sensor data)\n        sensor_msg = String()\n        sensor_msg.data = f\"SENSOR #{self.counter}: x=1.2, y=3.4, z=5.6\"\n        self.best_effort_pub.publish(sensor_msg)\n\n        self.get_logger().info(f'Published message set #{self.counter}')\n\n\nclass QoSSubscriberNode(Node):\n    \"\"\"Subscribes with matching QoS policies\"\"\"\n\n    def __init__(self):\n        super().__init__('qos_subscriber')\n\n        # Subscribe to reliable topic\n        reliable_qos = QoSProfile(\n            reliability=ReliabilityPolicy.RELIABLE,\n            durability=DurabilityPolicy.VOLATILE,\n            history=HistoryPolicy.KEEP_LAST,\n            depth=10\n        )\n\n        self.create_subscription(\n            String,\n            'reliable_topic',\n            lambda msg: self.get_logger().info(f'RELIABLE: {msg.data}'),\n            reliable_qos\n        )\n\n        # Subscribe to best-effort topic\n        best_effort_qos = QoSProfile(\n            reliability=ReliabilityPolicy.BEST_EFFORT,\n            durability=DurabilityPolicy.VOLATILE,\n            history=HistoryPolicy.KEEP_LAST,\n            depth=1\n        )\n\n        self.create_subscription(\n            String,\n            'best_effort_topic',\n            lambda msg: self.get_logger().info(f'BEST_EFFORT: {msg.data}'),\n            best_effort_qos\n        )\n\n        # Subscribe to config topic (will receive last message even if late)\n        transient_qos = QoSProfile(\n            reliability=ReliabilityPolicy.RELIABLE,\n            durability=DurabilityPolicy.TRANSIENT_LOCAL,\n            history=HistoryPolicy.KEEP_LAST,\n            depth=1\n        )\n\n        self.create_subscription(\n            String,\n            'config_topic',\n            lambda msg: self.get_logger().info(f'CONFIG: {msg.data}'),\n            transient_qos\n        )\n\n        self.get_logger().info('QoS Subscriber started')\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    # Choose which node to run based on command-line argument\n    import sys\n    if len(sys.argv) > 1 and sys.argv[1] == 'sub':\n        node = QoSSubscriberNode()\n    else:\n        node = QoSDemoNode()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n\n    node.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"running-the-qos-demo",children:"Running the QoS Demo"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Terminal 1: Start publisher\npython3 qos_demo.py\n\n# Terminal 2: Start subscriber immediately\npython3 qos_demo.py sub\n\n# Terminal 3: Start subscriber after 5 seconds (late-joiner)\nsleep 5 && python3 qos_demo.py sub\n# Notice: Late-joiner still receives config message due to TRANSIENT_LOCAL!\n"})}),"\n",(0,i.jsx)(n.h3,{id:"experiment-qos-incompatibility",children:"Experiment: QoS Incompatibility"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Terminal 1: Publisher with BEST_EFFORT\nros2 topic pub /test std_msgs/String \"data: 'hello'\" \\\n    --qos-reliability best_effort\n\n# Terminal 2: Subscriber demanding RELIABLE (won't connect!)\nros2 topic echo /test --qos-reliability reliable\n\n# Check why they're not connecting\nros2 topic info /test -v\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"example-4-multi-node-system",children:"Example 4: Multi-Node System"}),"\n",(0,i.jsx)(n.p,{children:"This example shows multiple nodes working together in a simple perception pipeline."}),"\n",(0,i.jsxs)(n.h3,{id:"code-camera_simulatorpy",children:["Code: ",(0,i.jsx)(n.code,{children:"camera_simulator.py"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n\"\"\"\nCamera Simulator Node\nPublishes simulated camera images at 30Hz\n\"\"\"\n\nimport rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import Image\nfrom rclpy.qos import qos_profile_sensor_data\nimport numpy as np\n\n\nclass CameraSimulatorNode(Node):\n    def __init__(self):\n        super().__init__('camera_simulator')\n\n        # Use sensor_data QoS profile (BEST_EFFORT for high-frequency data)\n        self.publisher_ = self.create_publisher(\n            Image,\n            'camera/image_raw',\n            qos_profile_sensor_data\n        )\n\n        # 30Hz camera\n        self.timer = self.create_timer(1.0/30.0, self.publish_image)\n        self.frame_count = 0\n\n        self.get_logger().info('Camera simulator started (30Hz)')\n\n    def publish_image(self):\n        \"\"\"Publish simulated image\"\"\"\n        msg = Image()\n        msg.header.stamp = self.get_clock().now().to_msg()\n        msg.header.frame_id = 'camera_link'\n        msg.height = 480\n        msg.width = 640\n        msg.encoding = 'rgb8'\n        msg.step = msg.width * 3\n\n        # Simulate image data (normally from actual camera)\n        msg.data = np.random.randint(0, 255, (msg.height, msg.width, 3), dtype=np.uint8).tobytes()\n\n        self.publisher_.publish(msg)\n        self.frame_count += 1\n\n        if self.frame_count % 30 == 0:  # Log every second\n            self.get_logger().debug(f'Published frame {self.frame_count}')\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = CameraSimulatorNode()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n\n    node.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"code-image_processorpy",children:["Code: ",(0,i.jsx)(n.code,{children:"image_processor.py"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'#!/usr/bin/env python3\n"""\nImage Processor Node\nReceives images and performs simple processing\n"""\n\nimport rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import Image\nfrom std_msgs.msg import String\nfrom rclpy.qos import qos_profile_sensor_data\n\n\nclass ImageProcessorNode(Node):\n    def __init__(self):\n        super().__init__(\'image_processor\')\n\n        # Subscribe to camera images\n        self.subscription = self.create_subscription(\n            Image,\n            \'camera/image_raw\',\n            self.image_callback,\n            qos_profile_sensor_data\n        )\n\n        # Publish detection results\n        self.detection_pub = self.create_publisher(\n            String,\n            \'detections\',\n            10\n        )\n\n        self.frame_count = 0\n        self.get_logger().info(\'Image processor started\')\n\n    def image_callback(self, msg):\n        """Process incoming image"""\n        self.frame_count += 1\n\n        # Simulate processing (normally: object detection, etc.)\n        # Here we just check image size\n        if msg.height == 480 and msg.width == 640:\n            if self.frame_count % 30 == 0:  # Detect "object" every second\n                detection_msg = String()\n                detection_msg.data = f"Object detected at frame {self.frame_count}"\n                self.detection_pub.publish(detection_msg)\n                self.get_logger().info(detection_msg.data)\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = ImageProcessorNode()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n\n    node.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n",(0,i.jsx)(n.h3,{id:"running-the-multi-node-system",children:"Running the Multi-Node System"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Terminal 1: Camera simulator\npython3 camera_simulator.py\n\n# Terminal 2: Image processor\npython3 image_processor.py\n\n# Terminal 3: Monitor detections\nros2 topic echo /detections\n\n# Terminal 4: Visualize node graph\nros2 run rqt_graph rqt_graph\n\n# Terminal 5: Check system performance\nros2 topic hz /camera/image_raw\nros2 topic bw /camera/image_raw  # Bandwidth usage\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"example-5-using-ros-2-cli-tools",children:"Example 5: Using ROS 2 CLI Tools"}),"\n",(0,i.jsx)(n.h3,{id:"introspection-commands",children:"Introspection Commands"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# List all running nodes\nros2 node list\n\n# Get info about a specific node\nros2 node info /temperature_sensor\n\n# List all topics\nros2 topic list\n\n# Get detailed topic info (including QoS)\nros2 topic info /robot/temperature -v\n\n# Echo topic messages\nros2 topic echo /robot/temperature\n\n# Publish from command line\nros2 topic pub /robot/temperature sensor_msgs/Temperature \\\n    \"{header: {frame_id: 'base_link'}, temperature: 25.0, variance: 0.1}\"\n\n# Check publishing rate\nros2 topic hz /robot/temperature\n\n# Check bandwidth usage\nros2 topic bw /camera/image_raw\n\n# View message type definition\nros2 interface show sensor_msgs/msg/Temperature\n\n# List all parameters of a node\nros2 param list /temperature_monitor\n\n# Get parameter value\nros2 param get /temperature_monitor warning_threshold\n\n# Set parameter value\nros2 param set /temperature_monitor warning_threshold 28.0\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"common-pitfalls-and-solutions",children:"Common Pitfalls and Solutions"}),"\n",(0,i.jsx)(n.h3,{id:"pitfall-1-qos-incompatibility",children:"Pitfall 1: QoS Incompatibility"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": Subscriber not receiving messages"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Check QoS settings\nros2 topic info /my_topic -v\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution"}),": Ensure publisher and subscriber QoS are compatible"]}),"\n",(0,i.jsx)(n.h3,{id:"pitfall-2-forgetting-to-source-setup",children:"Pitfall 2: Forgetting to Source Setup"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": ",(0,i.jsx)(n.code,{children:"ros2: command not found"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'source /opt/ros/humble/setup.bash\n# Add to ~/.bashrc to make permanent\necho "source /opt/ros/humble/setup.bash" >> ~/.bashrc\n'})}),"\n",(0,i.jsx)(n.h3,{id:"pitfall-3-node-name-conflicts",children:"Pitfall 3: Node Name Conflicts"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": ",(0,i.jsx)(n.code,{children:"Node name already exists"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution"}),": Each node must have a unique name"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Add namespace or unique suffix\nsuper().__init__('temperature_sensor_1')\n"})}),"\n",(0,i.jsx)(n.h3,{id:"pitfall-4-callback-blocking",children:"Pitfall 4: Callback Blocking"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": Slow callback blocks other callbacks"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution"}),": Keep callbacks fast; offload heavy work to threads"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import threading\n\ndef image_callback(self, msg):\n    # Quick: just queue the work\n    threading.Thread(target=self.process_image, args=(msg,)).start()\n\ndef process_image(self, msg):\n    # Heavy processing here\n    pass\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(n.p,{children:"These examples demonstrate:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"\u2705 Creating publishers and subscribers"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Configuring QoS policies for different use cases"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Using parameters for runtime configuration"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Building multi-node systems"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Using ROS 2 CLI tools for debugging"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Next Steps"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Try modifying these examples"}),"\n",(0,i.jsx)(n.li,{children:"Combine them into a larger system"}),"\n",(0,i.jsxs)(n.li,{children:["Complete the ",(0,i.jsx)(n.a,{href:"./hands-on-lab",children:"Hands-On Lab"})," to build a full application"]}),"\n",(0,i.jsxs)(n.li,{children:["Test your understanding with ",(0,i.jsx)(n.a,{href:"./exercises",children:"Exercises"})]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{title:"Best Practice",type:"tip",children:(0,i.jsx)(n.p,{children:"Always start with working examples and modify incrementally. Test each change before adding more complexity."})})]})}function m(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>o,x:()=>a});var r=s(6540);const i={},t=r.createContext(i);function o(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);