"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_textbook=globalThis.webpackChunkphysical_ai_humanoid_robotics_textbook||[]).push([[1561],{3182(e,n,s){s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>m,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"chapters/chapter-02-ros2-architecture/exercises","title":"Exercises: ROS 2 Architecture","description":"Practice exercises to reinforce ROS 2 architecture concepts","source":"@site/docs/chapters/chapter-02-ros2-architecture/exercises.md","sourceDirName":"chapters/chapter-02-ros2-architecture","slug":"/chapters/chapter-02-ros2-architecture/exercises","permalink":"/Ai--book-/docs/chapters/chapter-02-ros2-architecture/exercises","draft":false,"unlisted":false,"editUrl":"https://github.com/aurangzaibmughal/Ai--book-/edit/main/docs/chapters/chapter-02-ros2-architecture/exercises.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"id":"exercises","title":"Exercises: ROS 2 Architecture","sidebar_label":"Exercises","sidebar_position":8,"description":"Practice exercises to reinforce ROS 2 architecture concepts"},"sidebar":"tutorialSidebar","previous":{"title":"Code Examples","permalink":"/Ai--book-/docs/chapters/chapter-02-ros2-architecture/code-examples"},"next":{"title":"Dependencies","permalink":"/Ai--book-/docs/chapters/chapter-02-ros2-architecture/dependencies"}}');var r=s(4848),t=s(8453);const a={id:"exercises",title:"Exercises: ROS 2 Architecture",sidebar_label:"Exercises",sidebar_position:8,description:"Practice exercises to reinforce ROS 2 architecture concepts"},l="Exercises: ROS 2 Architecture",o={},c=[{value:"Exercise 1: QoS Policy Configuration (Beginner)",id:"exercise-1-qos-policy-configuration-beginner",level:2},{value:"Task",id:"task",level:3},{value:"Requirements",id:"requirements",level:3},{value:"Expected Output",id:"expected-output",level:3},{value:"Hints",id:"hints",level:3},{value:"Solution Verification",id:"solution-verification",level:3},{value:"Exercise 2: Multi-Sensor Fusion (Intermediate)",id:"exercise-2-multi-sensor-fusion-intermediate",level:2},{value:"Task",id:"task-1",level:3},{value:"Requirements",id:"requirements-1",level:3},{value:"Expected Behavior",id:"expected-behavior",level:3},{value:"Hints",id:"hints-1",level:3},{value:"Bonus Challenge",id:"bonus-challenge",level:3},{value:"Exercise 3: Node Lifecycle Management (Intermediate)",id:"exercise-3-node-lifecycle-management-intermediate",level:2},{value:"Task",id:"task-2",level:3},{value:"Requirements",id:"requirements-2",level:3},{value:"Expected Output",id:"expected-output-1",level:3},{value:"Hints",id:"hints-2",level:3},{value:"Exercise 4: Custom Message Types (Intermediate)",id:"exercise-4-custom-message-types-intermediate",level:2},{value:"Task",id:"task-3",level:3},{value:"Requirements",id:"requirements-3",level:3},{value:"Steps",id:"steps",level:3},{value:"Expected Output",id:"expected-output-2",level:3},{value:"Exercise 5: Parameter Server Integration (Advanced)",id:"exercise-5-parameter-server-integration-advanced",level:2},{value:"Task",id:"task-4",level:3},{value:"Requirements",id:"requirements-4",level:3},{value:"Expected Behavior",id:"expected-behavior-1",level:3},{value:"Exercise 6: Multi-Robot System (Advanced)",id:"exercise-6-multi-robot-system-advanced",level:2},{value:"Task",id:"task-5",level:3},{value:"Requirements",id:"requirements-5",level:3},{value:"Running the System",id:"running-the-system",level:3},{value:"Hints",id:"hints-3",level:3},{value:"Exercise 7: Performance Optimization (Advanced)",id:"exercise-7-performance-optimization-advanced",level:2},{value:"Task",id:"task-6",level:3},{value:"Requirements",id:"requirements-6",level:3},{value:"Solution Approach",id:"solution-approach",level:3},{value:"Performance Targets",id:"performance-targets",level:3},{value:"Measurement",id:"measurement",level:3},{value:"Exercise 8: Debugging Challenge (Advanced)",id:"exercise-8-debugging-challenge-advanced",level:2},{value:"Scenario",id:"scenario",level:3},{value:"Your Task",id:"your-task",level:3},{value:"Debugging Checklist",id:"debugging-checklist",level:3},{value:"Common Issues to Find",id:"common-issues-to-find",level:3},{value:"Solution Template",id:"solution-template",level:3},{value:"Bonus Exercise: Build a Complete System",id:"bonus-exercise-build-a-complete-system",level:2},{value:"Task",id:"task-7",level:3},{value:"Architecture",id:"architecture",level:3},{value:"Requirements",id:"requirements-7",level:3},{value:"Submission Guidelines",id:"submission-guidelines",level:2},{value:"Grading Rubric",id:"grading-rubric",level:3},{value:"Additional Challenges",id:"additional-challenges",level:2}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"exercises-ros-2-architecture",children:"Exercises: ROS 2 Architecture"})}),"\n",(0,r.jsx)(n.p,{children:"These exercises reinforce the concepts learned in this chapter. Complete them in order, as they build on each other."}),"\n",(0,r.jsx)(n.h2,{id:"exercise-1-qos-policy-configuration-beginner",children:"Exercise 1: QoS Policy Configuration (Beginner)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Objective"}),": Understand how different QoS policies affect message delivery."]}),"\n",(0,r.jsx)(n.h3,{id:"task",children:"Task"}),"\n",(0,r.jsx)(n.p,{children:"Create two nodes:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Publisher"}),": Publishes messages with different QoS profiles"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Subscriber"}),": Subscribes with various QoS profiles to test compatibility"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"requirements",children:"Requirements"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Create a publisher that publishes to three topics:\n# - /reliable_topic (RELIABLE QoS)\n# - /best_effort_topic (BEST_EFFORT QoS)\n# - /transient_topic (TRANSIENT_LOCAL durability)\n\n# Create subscribers that:\n# 1. Successfully receive from /reliable_topic\n# 2. Successfully receive from /best_effort_topic\n# 3. Fail to receive due to QoS mismatch\n# 4. Receive historical data from /transient_topic when started late\n"})}),"\n",(0,r.jsx)(n.h3,{id:"expected-output",children:"Expected Output"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Publisher] Publishing to reliable_topic: Message 1\n[Publisher] Publishing to best_effort_topic: Message 1\n[Publisher] Publishing to transient_topic: Config data\n\n[Subscriber 1] Received from reliable_topic: Message 1\n[Subscriber 2] Received from best_effort_topic: Message 1\n[Subscriber 3] ERROR: No data (QoS mismatch)\n[Subscriber 4] Received historical data: Config data\n"})}),"\n",(0,r.jsx)(n.h3,{id:"hints",children:"Hints"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"QoSProfile"})," to configure reliability and durability"]}),"\n",(0,r.jsxs)(n.li,{children:["Test QoS compatibility with ",(0,r.jsx)(n.code,{children:"ros2 topic info -v"})]}),"\n",(0,r.jsx)(n.li,{children:"Start subscriber 4 after publisher has been running for 5 seconds"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"solution-verification",children:"Solution Verification"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Check QoS settings\nros2 topic info /reliable_topic -v\nros2 topic info /best_effort_topic -v\nros2 topic info /transient_topic -v\n\n# Verify incompatibility\nros2 topic echo /reliable_topic --qos-reliability best_effort\n# Should show: "Could not connect to topic"\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"exercise-2-multi-sensor-fusion-intermediate",children:"Exercise 2: Multi-Sensor Fusion (Intermediate)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Objective"}),": Combine data from multiple sensors with different publishing rates."]}),"\n",(0,r.jsx)(n.h3,{id:"task-1",children:"Task"}),"\n",(0,r.jsx)(n.p,{children:"Create a sensor fusion node that:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Subscribes to camera images (30Hz, BEST_EFFORT)"}),"\n",(0,r.jsx)(n.li,{children:"Subscribes to LIDAR scans (10Hz, BEST_EFFORT)"}),"\n",(0,r.jsx)(n.li,{children:"Subscribes to IMU data (100Hz, RELIABLE)"}),"\n",(0,r.jsx)(n.li,{children:"Publishes synchronized sensor data (10Hz, RELIABLE)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"requirements-1",children:"Requirements"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n\"\"\"\nSensor Fusion Node\nDemonstrates multi-sensor data fusion with different rates and QoS policies\n\"\"\"\n\nimport rclpy\nfrom rclpy.node import Node\nfrom rclpy.qos import QoSProfile, ReliabilityPolicy, HistoryPolicy\nfrom sensor_msgs.msg import Image, LaserScan, Imu\nfrom std_msgs.msg import String\nfrom collections import deque\nfrom typing import Optional\n\n\nclass SensorFusionNode(Node):\n    \"\"\"\n    Fuses data from multiple sensors\n    - Buffers high-frequency data (camera, IMU)\n    - Synchronizes to LIDAR rate (10Hz)\n    - Publishes combined sensor state\n    \"\"\"\n\n    def __init__(self):\n        super().__init__('sensor_fusion')\n\n        # Create subscribers with appropriate QoS policies\n        # Camera: 30Hz, BEST_EFFORT (occasional frame drops acceptable)\n        camera_qos = QoSProfile(\n            reliability=ReliabilityPolicy.BEST_EFFORT,\n            history=HistoryPolicy.KEEP_LAST,\n            depth=10\n        )\n        self.camera_sub = self.create_subscription(\n            Image,\n            'camera/image',\n            self.camera_callback,\n            camera_qos\n        )\n\n        # LIDAR: 10Hz, BEST_EFFORT (drives fusion rate)\n        lidar_qos = QoSProfile(\n            reliability=ReliabilityPolicy.BEST_EFFORT,\n            history=HistoryPolicy.KEEP_LAST,\n            depth=10\n        )\n        self.lidar_sub = self.create_subscription(\n            LaserScan,\n            'lidar/scan',\n            self.lidar_callback,\n            lidar_qos\n        )\n\n        # IMU: 100Hz, RELIABLE (critical for robot stability)\n        imu_qos = QoSProfile(\n            reliability=ReliabilityPolicy.RELIABLE,\n            history=HistoryPolicy.KEEP_LAST,\n            depth=50  # Larger buffer for high-frequency data\n        )\n        self.imu_sub = self.create_subscription(\n            Imu,\n            'imu/data',\n            self.imu_callback,\n            imu_qos\n        )\n\n        # Create publisher for fused data (10Hz, RELIABLE)\n        # RELIABLE because downstream nodes need guaranteed delivery\n        fused_qos = QoSProfile(\n            reliability=ReliabilityPolicy.RELIABLE,\n            history=HistoryPolicy.KEEP_LAST,\n            depth=10\n        )\n        self.fused_pub = self.create_publisher(\n            String,  # In production, use custom message type\n            'sensor/fused',\n            fused_qos\n        )\n\n        # Implement time-based synchronization\n        # Buffer recent messages from high-frequency sensors\n        # We keep last 1 second of data for synchronization\n        self.camera_buffer = deque(maxlen=30)  # 30 frames at 30Hz = 1 second\n        self.imu_buffer = deque(maxlen=100)    # 100 samples at 100Hz = 1 second\n\n        # Track latest LIDAR scan (slowest sensor, drives fusion)\n        self.latest_lidar: Optional[LaserScan] = None\n        self.latest_lidar_time: Optional[float] = None\n\n        # Counters for logging\n        self.camera_count = 0\n        self.lidar_count = 0\n        self.imu_count = 0\n\n        self.get_logger().info('Sensor fusion node started')\n        self.get_logger().info('Waiting for sensor data...')\n\n    def camera_callback(self, msg: Image):\n        \"\"\"\n        Callback for camera images (30Hz)\n        Buffers frames for time-based synchronization\n        \"\"\"\n        timestamp = self.get_clock().now().nanoseconds / 1e9  # Convert to seconds\n        self.camera_buffer.append((timestamp, msg))\n        self.camera_count += 1\n\n        self.get_logger().debug(\n            f'Received camera frame {self.camera_count} at t={timestamp:.3f}s'\n        )\n\n    def imu_callback(self, msg: Imu):\n        \"\"\"\n        Callback for IMU data (100Hz)\n        Buffers samples for time-based synchronization\n        \"\"\"\n        timestamp = self.get_clock().now().nanoseconds / 1e9\n        self.imu_buffer.append((timestamp, msg))\n        self.imu_count += 1\n\n        self.get_logger().debug(\n            f'Received IMU sample {self.imu_count} at t={timestamp:.3f}s'\n        )\n\n    def lidar_callback(self, msg: LaserScan):\n        \"\"\"\n        Callback for LIDAR scans (10Hz)\n        Triggers sensor fusion when new scan arrives\n\n        LIDAR is the slowest sensor, so we use it to drive the fusion rate.\n        When a LIDAR scan arrives, we find the closest camera frame and\n        IMU samples within a time window and publish fused data.\n        \"\"\"\n        timestamp = self.get_clock().now().nanoseconds / 1e9\n        self.latest_lidar = msg\n        self.latest_lidar_time = timestamp\n        self.lidar_count += 1\n\n        self.get_logger().info(\n            f'Received LIDAR scan {self.lidar_count} at t={timestamp:.3f}s'\n        )\n\n        # Trigger fusion when LIDAR data arrives\n        self.publish_fused_data()\n\n    def publish_fused_data(self):\n        \"\"\"\n        Publishes synchronized sensor data\n\n        Synchronization strategy:\n        1. Use LIDAR timestamp as reference (slowest sensor)\n        2. Find closest camera frame within 50ms window\n        3. Collect all IMU samples within 100ms window\n        4. Publish combined sensor state\n        \"\"\"\n        if self.latest_lidar is None:\n            return\n\n        if not self.camera_buffer or not self.imu_buffer:\n            self.get_logger().warn('Waiting for all sensors to publish data')\n            return\n\n        lidar_time = self.latest_lidar_time\n        time_tolerance = 0.05  # 50ms tolerance for camera sync\n\n        # Find closest camera frame to LIDAR timestamp\n        closest_camera = None\n        min_time_diff = float('inf')\n\n        for cam_time, cam_msg in self.camera_buffer:\n            time_diff = abs(cam_time - lidar_time)\n            if time_diff < min_time_diff and time_diff < time_tolerance:\n                min_time_diff = time_diff\n                closest_camera = (cam_time, cam_msg)\n\n        # Collect IMU samples within 100ms window around LIDAR timestamp\n        imu_window = 0.1  # 100ms window\n        synchronized_imu = [\n            (imu_time, imu_msg)\n            for imu_time, imu_msg in self.imu_buffer\n            if abs(imu_time - lidar_time) < imu_window\n        ]\n\n        # Publish fused data\n        if closest_camera is not None:\n            fused_msg = String()\n            fused_msg.data = (\n                f'Fused data: '\n                f'camera_frame={self.camera_count}, '\n                f'lidar_scan={self.lidar_count}, '\n                f'imu_samples={len(synchronized_imu)}, '\n                f'sync_error={min_time_diff*1000:.1f}ms'\n            )\n\n            self.fused_pub.publish(fused_msg)\n\n            self.get_logger().info(\n                f'Publishing fused data: '\n                f'camera_frame={self.camera_count}, '\n                f'lidar_scan={self.lidar_count}, '\n                f'imu_samples={len(synchronized_imu)}'\n            )\n        else:\n            self.get_logger().warn(\n                f'No camera frame within {time_tolerance*1000}ms of LIDAR scan'\n            )\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = SensorFusionNode()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"expected-behavior",children:"Expected Behavior"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[Fusion] Received camera frame 1 at t=0.033s\n[Fusion] Received camera frame 2 at t=0.066s\n[Fusion] Received camera frame 3 at t=0.100s\n[Fusion] Received LIDAR scan at t=0.100s\n[Fusion] Publishing fused data: camera_frame=3, lidar_scan=1, imu_samples=10\n"})}),"\n",(0,r.jsx)(n.h3,{id:"hints-1",children:"Hints"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"self.get_clock().now()"})," for timestamps"]}),"\n",(0,r.jsx)(n.li,{children:"Buffer recent messages from high-frequency sensors"}),"\n",(0,r.jsx)(n.li,{children:"Publish when LIDAR data arrives (slowest sensor)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"bonus-challenge",children:"Bonus Challenge"}),"\n",(0,r.jsx)(n.p,{children:"Implement a time-based synchronization algorithm that matches sensor data within 10ms tolerance."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"exercise-3-node-lifecycle-management-intermediate",children:"Exercise 3: Node Lifecycle Management (Intermediate)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Objective"}),": Implement proper node initialization and shutdown."]}),"\n",(0,r.jsx)(n.h3,{id:"task-2",children:"Task"}),"\n",(0,r.jsx)(n.p,{children:"Create a camera driver node with lifecycle management:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Configuring"}),": Load parameters, validate settings"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Activating"}),": Initialize camera, start publishing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Deactivating"}),": Stop publishing, keep camera open"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cleaning up"}),": Close camera, release resources"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"requirements-2",children:"Requirements"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from rclpy.lifecycle import LifecycleNode, LifecycleState, TransitionCallbackReturn\n\nclass CameraDriverNode(LifecycleNode):\n    """Camera driver with lifecycle management"""\n\n    def on_configure(self, state: LifecycleState):\n        # Load parameters\n        # Validate camera settings\n        # Return SUCCESS or FAILURE\n        pass\n\n    def on_activate(self, state: LifecycleState):\n        # Initialize camera\n        # Start publishing\n        pass\n\n    def on_deactivate(self, state: LifecycleState):\n        # Stop publishing\n        pass\n\n    def on_cleanup(self, state: LifecycleState):\n        # Release camera resources\n        pass\n'})}),"\n",(0,r.jsx)(n.h3,{id:"expected-output-1",children:"Expected Output"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Terminal 1: Run lifecycle node\nros2 run my_package camera_driver\n\n# Terminal 2: Control lifecycle\nros2 lifecycle set /camera_driver configure\n# [Camera] Configuring... Parameters loaded\n\nros2 lifecycle set /camera_driver activate\n# [Camera] Activating... Camera initialized, publishing started\n\nros2 lifecycle set /camera_driver deactivate\n# [Camera] Deactivating... Publishing stopped\n\nros2 lifecycle set /camera_driver cleanup\n# [Camera] Cleaning up... Camera released\n"})}),"\n",(0,r.jsx)(n.h3,{id:"hints-2",children:"Hints"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"LifecycleNode"})," instead of ",(0,r.jsx)(n.code,{children:"Node"})]}),"\n",(0,r.jsxs)(n.li,{children:["Return ",(0,r.jsx)(n.code,{children:"TransitionCallbackReturn.SUCCESS"})," or ",(0,r.jsx)(n.code,{children:"FAILURE"})]}),"\n",(0,r.jsxs)(n.li,{children:["Test with ",(0,r.jsx)(n.code,{children:"ros2 lifecycle"})," commands"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"exercise-4-custom-message-types-intermediate",children:"Exercise 4: Custom Message Types (Intermediate)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Objective"}),": Define and use custom ROS 2 message types."]}),"\n",(0,r.jsx)(n.h3,{id:"task-3",children:"Task"}),"\n",(0,r.jsx)(n.p,{children:"Create a custom message for robot status:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# RobotStatus.msg\nstd_msgs/Header header\nfloat32 battery_percentage\nfloat32 temperature\nstring health_status\ngeometry_msgs/Pose current_pose\nstring[] active_tasks\n"})}),"\n",(0,r.jsx)(n.h3,{id:"requirements-3",children:"Requirements"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Create message definition in ",(0,r.jsx)(n.code,{children:"msg/RobotStatus.msg"})]}),"\n",(0,r.jsxs)(n.li,{children:["Update ",(0,r.jsx)(n.code,{children:"CMakeLists.txt"})," and ",(0,r.jsx)(n.code,{children:"package.xml"})]}),"\n",(0,r.jsx)(n.li,{children:"Build and verify message generation"}),"\n",(0,r.jsx)(n.li,{children:"Create publisher and subscriber using custom message"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"steps",children:"Steps"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# 1. Create message directory\nmkdir -p ~/ros2_ws/src/my_robot/msg\n\n# 2. Create RobotStatus.msg file\n\n# 3. Update package.xml\n<build_depend>rosidl_default_generators</build_depend>\n<exec_depend>rosidl_default_runtime</exec_depend>\n<member_of_group>rosidl_interface_packages</member_of_group>\n\n# 4. Update CMakeLists.txt (for C++ packages)\nfind_package(rosidl_default_generators REQUIRED)\nrosidl_generate_interfaces(${PROJECT_NAME}\n  "msg/RobotStatus.msg"\n  DEPENDENCIES std_msgs geometry_msgs\n)\n\n# 5. Build\ncolcon build --packages-select my_robot\n\n# 6. Verify\nros2 interface show my_robot/msg/RobotStatus\n'})}),"\n",(0,r.jsx)(n.h3,{id:"expected-output-2",children:"Expected Output"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from my_robot.msg import RobotStatus\n\nmsg = RobotStatus()\nmsg.battery_percentage = 85.5\nmsg.temperature = 26.3\nmsg.health_status = "HEALTHY"\n# ... publish msg\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"exercise-5-parameter-server-integration-advanced",children:"Exercise 5: Parameter Server Integration (Advanced)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Objective"}),": Implement dynamic parameter updates with validation."]}),"\n",(0,r.jsx)(n.h3,{id:"task-4",children:"Task"}),"\n",(0,r.jsx)(n.p,{children:"Create a motor controller node that:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Declares parameters with constraints"}),"\n",(0,r.jsx)(n.li,{children:"Validates parameter changes"}),"\n",(0,r.jsx)(n.li,{children:"Applies parameters dynamically"}),"\n",(0,r.jsx)(n.li,{children:"Saves parameters to file"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"requirements-4",children:"Requirements"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class MotorControllerNode(Node):\n    def __init__(self):\n        super().__init__('motor_controller')\n\n        # Declare parameters with descriptors\n        self.declare_parameter(\n            'max_speed',\n            1.0,\n            ParameterDescriptor(\n                description='Maximum speed in m/s',\n                type=ParameterType.PARAMETER_DOUBLE,\n                read_only=False,\n                additional_constraints='Must be between 0.1 and 5.0'\n            )\n        )\n\n        # Add parameter callback\n        self.add_on_set_parameters_callback(self.parameter_callback)\n\n    def parameter_callback(self, params):\n        \"\"\"Validate and apply parameter changes\"\"\"\n        for param in params:\n            if param.name == 'max_speed':\n                if param.value < 0.1 or param.value > 5.0:\n                    return SetParametersResult(successful=False)\n                # Apply new speed limit\n                self.max_speed = param.value\n\n        return SetParametersResult(successful=True)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"expected-behavior-1",children:"Expected Behavior"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Set valid parameter\nros2 param set /motor_controller max_speed 2.5\n# Output: Set parameter successful\n\n# Set invalid parameter\nros2 param set /motor_controller max_speed 10.0\n# Output: Setting parameter failed: Value out of range\n\n# Dump parameters to file\nros2 param dump /motor_controller --output-dir ~/params\n\n# Load parameters from file\nros2 run my_package motor_controller --ros-args --params-file ~/params/motor_controller.yaml\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"exercise-6-multi-robot-system-advanced",children:"Exercise 6: Multi-Robot System (Advanced)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Objective"}),": Create a system that coordinates multiple robots using ROS domains."]}),"\n",(0,r.jsx)(n.h3,{id:"task-5",children:"Task"}),"\n",(0,r.jsx)(n.p,{children:"Simulate a warehouse with 3 robots:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Each robot has its own ROS domain"}),"\n",(0,r.jsx)(n.li,{children:"A central coordinator communicates with all robots"}),"\n",(0,r.jsx)(n.li,{children:"Robots publish their positions"}),"\n",(0,r.jsx)(n.li,{children:"Coordinator assigns tasks based on robot locations"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"requirements-5",children:"Requirements"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Robot node (runs in domain 1, 2, or 3)\nclass WarehouseRobotNode(Node):\n    def __init__(self, robot_id):\n        super().__init__(f'robot_{robot_id}')\n        # Publish position in own domain\n        # Subscribe to task assignments\n        pass\n\n# Coordinator node (runs in domain 0, bridges to 1, 2, 3)\nclass CoordinatorNode(Node):\n    def __init__(self):\n        super().__init__('coordinator')\n        # Subscribe to all robot positions\n        # Publish task assignments\n        pass\n"})}),"\n",(0,r.jsx)(n.h3,{id:"running-the-system",children:"Running the System"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Terminal 1: Robot 1 (domain 1)\nexport ROS_DOMAIN_ID=1\nros2 run warehouse robot --ros-args -p robot_id:=1\n\n# Terminal 2: Robot 2 (domain 2)\nexport ROS_DOMAIN_ID=2\nros2 run warehouse robot --ros-args -p robot_id:=2\n\n# Terminal 3: Robot 3 (domain 3)\nexport ROS_DOMAIN_ID=3\nros2 run warehouse robot --ros-args -p robot_id:=3\n\n# Terminal 4: Coordinator (domain 0, bridges to all)\nexport ROS_DOMAIN_ID=0\nros2 run warehouse coordinator\n"})}),"\n",(0,r.jsx)(n.h3,{id:"hints-3",children:"Hints"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use domain bridging or run coordinator in each domain"}),"\n",(0,r.jsxs)(n.li,{children:["Consider using ",(0,r.jsx)(n.code,{children:"ros2 topic list"})," with ",(0,r.jsx)(n.code,{children:"--include-hidden-topics"})]}),"\n",(0,r.jsx)(n.li,{children:"Implement task assignment algorithm (e.g., nearest robot)"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"exercise-7-performance-optimization-advanced",children:"Exercise 7: Performance Optimization (Advanced)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Objective"}),": Optimize a ROS 2 system for real-time performance."]}),"\n",(0,r.jsx)(n.h3,{id:"task-6",children:"Task"}),"\n",(0,r.jsx)(n.p,{children:"Given a slow image processing pipeline, optimize it to achieve 30Hz throughput:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Original (slow) implementation\nclass ImageProcessorNode(Node):\n    def image_callback(self, msg):\n        # Blocking operation - processes image synchronously\n        processed = self.process_image(msg)  # Takes 50ms\n        self.publisher_.publish(processed)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"requirements-6",children:"Requirements"}),"\n",(0,r.jsx)(n.p,{children:"Optimize using:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Callback groups"}),": Parallel callback execution"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Executors"}),": Multi-threaded processing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Intra-process communication"}),": Zero-copy message passing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"QoS tuning"}),": Reduce latency"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"solution-approach",children:"Solution Approach"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rclpy.executors import MultiThreadedExecutor\nfrom rclpy.callback_groups import ReentrantCallbackGroup\nimport threading\n\nclass OptimizedImageProcessorNode(Node):\n    def __init__(self):\n        super().__init__('optimized_processor')\n\n        # Use reentrant callback group for parallel execution\n        self.callback_group = ReentrantCallbackGroup()\n\n        # Subscribe with callback group\n        self.subscription = self.create_subscription(\n            Image,\n            'camera/image',\n            self.image_callback,\n            qos_profile_sensor_data,\n            callback_group=self.callback_group\n        )\n\n        # Thread pool for processing\n        self.executor = ThreadPoolExecutor(max_workers=4)\n\n    def image_callback(self, msg):\n        # Non-blocking: submit to thread pool\n        self.executor.submit(self.process_and_publish, msg)\n\n    def process_and_publish(self, msg):\n        processed = self.process_image(msg)\n        self.publisher_.publish(processed)\n\n# Run with multi-threaded executor\nexecutor = MultiThreadedExecutor(num_threads=4)\nexecutor.add_node(node)\nexecutor.spin()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"performance-targets",children:"Performance Targets"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Latency"}),": < 35ms (camera to processed output)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Throughput"}),": 30Hz sustained"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"CPU Usage"}),": < 50% on single core"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Memory"}),": No memory leaks over 1 hour"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"measurement",children:"Measurement"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Measure latency\nros2 topic delay /processed_image\n\n# Measure throughput\nros2 topic hz /processed_image\n\n# Profile CPU usage\nros2 run performance_test perf_test\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"exercise-8-debugging-challenge-advanced",children:"Exercise 8: Debugging Challenge (Advanced)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Objective"}),": Debug a broken ROS 2 system using systematic troubleshooting."]}),"\n",(0,r.jsx)(n.h3,{id:"scenario",children:"Scenario"}),"\n",(0,r.jsx)(n.p,{children:"You're given a robot system that isn't working correctly:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Camera node publishes images"}),"\n",(0,r.jsx)(n.li,{children:"Object detector subscribes but receives no data"}),"\n",(0,r.jsx)(n.li,{children:"Motion planner crashes randomly"}),"\n",(0,r.jsx)(n.li,{children:"System becomes unresponsive after 5 minutes"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"your-task",children:"Your Task"}),"\n",(0,r.jsx)(n.p,{children:"Use ROS 2 tools to diagnose and fix all issues."}),"\n",(0,r.jsx)(n.h3,{id:"debugging-checklist",children:"Debugging Checklist"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# 1. Check node status\nros2 node list\nros2 node info /object_detector\n\n# 2. Check topic connections\nros2 topic list\nros2 topic info /camera/image -v\n\n# 3. Check QoS compatibility\nros2 topic echo /camera/image --qos-reliability reliable\n\n# 4. Monitor system resources\nros2 topic bw /camera/image\nros2 topic hz /camera/image\n\n# 5. Check for errors\nros2 run rqt_console rqt_console\n\n# 6. Inspect parameters\nros2 param list /motion_planner\nros2 param get /motion_planner max_speed\n\n# 7. Record and replay\nros2 bag record -a\nros2 bag play <bag_file>\n"})}),"\n",(0,r.jsx)(n.h3,{id:"common-issues-to-find",children:"Common Issues to Find"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"QoS Mismatch"}),": Detector uses RELIABLE, camera uses BEST_EFFORT"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Memory Leak"}),": Motion planner doesn't destroy old messages"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Callback Blocking"}),": Long-running callback blocks executor"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameter Error"}),": Invalid parameter causes crash"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"solution-template",children:"Solution Template"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-markdown",children:'## Issue 1: Object Detector Not Receiving Data\n**Root Cause**: QoS incompatibility\n**Evidence**: `ros2 topic info -v` shows mismatched QoS\n**Fix**: Change detector to BEST_EFFORT QoS\n\n## Issue 2: Motion Planner Crashes\n**Root Cause**: Invalid parameter value\n**Evidence**: Error log shows "max_speed must be positive"\n**Fix**: Add parameter validation\n\n## Issue 3: System Unresponsive After 5 Minutes\n**Root Cause**: Memory leak in image buffer\n**Evidence**: `top` shows increasing memory usage\n**Fix**: Properly destroy old messages\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"bonus-exercise-build-a-complete-system",children:"Bonus Exercise: Build a Complete System"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Objective"}),": Integrate all concepts into a functional robot system."]}),"\n",(0,r.jsx)(n.h3,{id:"task-7",children:"Task"}),"\n",(0,r.jsx)(n.p,{children:'Build a "Security Robot" that:'}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Patrols a simulated environment"}),"\n",(0,r.jsx)(n.li,{children:"Detects intruders using camera"}),"\n",(0,r.jsx)(n.li,{children:"Sounds alarm when threat detected"}),"\n",(0,r.jsx)(n.li,{children:"Logs all events to database"}),"\n",(0,r.jsx)(n.li,{children:"Provides web dashboard for monitoring"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"architecture",children:"Architecture"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Camera    \u2502\u2500\u2500\u2500\u2500>\u2502   Detector   \u2502\u2500\u2500\u2500\u2500>\u2502   Alarm     \u2502\n\u2502   Driver    \u2502     \u2502   (AI Model) \u2502     \u2502   System    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                            \u2502\n                            \u2193\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502   Logger     \u2502\n                    \u2502   (Database) \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                            \u2502\n                            \u2193\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502   Web API    \u2502\n                    \u2502   (FastAPI)  \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(n.h3,{id:"requirements-7",children:"Requirements"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"All nodes use appropriate QoS policies"}),"\n",(0,r.jsx)(n.li,{children:"System handles node failures gracefully"}),"\n",(0,r.jsx)(n.li,{children:"Performance: 10Hz detection rate"}),"\n",(0,r.jsx)(n.li,{children:"Logging: All events persisted to SQLite"}),"\n",(0,r.jsx)(n.li,{children:"Dashboard: Real-time status display"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"submission-guidelines",children:"Submission Guidelines"}),"\n",(0,r.jsx)(n.p,{children:"For each exercise, submit:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Source code"}),": All Python files"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Package files"}),": ",(0,r.jsx)(n.code,{children:"package.xml"}),", ",(0,r.jsx)(n.code,{children:"setup.py"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Documentation"}),": README with build/run instructions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Screenshots"}),": Terminal output, rqt_graph"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Answers"}),": Response to reflection questions"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"grading-rubric",children:"Grading Rubric"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Criteria"}),(0,r.jsx)(n.th,{children:"Points"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Code Quality"}),(0,r.jsx)(n.td,{children:"25%"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Functionality"}),(0,r.jsx)(n.td,{children:"35%"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Documentation"}),(0,r.jsx)(n.td,{children:"20%"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Testing"}),(0,r.jsx)(n.td,{children:"20%"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"additional-challenges",children:"Additional Challenges"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Performance"}),": Optimize Exercise 7 to achieve 60Hz"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scalability"}),": Extend Exercise 6 to 10 robots"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Reliability"}),": Add fault tolerance to Exercise 8"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Integration"}),": Combine Exercises 2, 3, and 5"]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"Learning Strategy",type:"tip",children:(0,r.jsx)(n.p,{children:"Don't rush through these exercises. Each one teaches important concepts you'll use throughout the course. Take time to experiment and understand why things work the way they do."})})]})}function m(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>a,x:()=>l});var i=s(6540);const r={},t=i.createContext(r);function a(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);